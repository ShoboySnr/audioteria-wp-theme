<?php
/**
 * Single Product Rating
 *
 * This template can be overridden by copying it to yourtheme/woocommerce/single-product/rating.php.
 *
 * HOWEVER, on occasion WooCommerce will need to update template files and you
 * (the theme developer) will need to copy the new files to your theme to
 * maintain compatibility. We try to do this as little as possible, but it does
 * happen. When this occurs the version of the template file will be bumped and
 * the readme will list any important changes.
 *
 * @see     https://docs.woocommerce.com/document/template-structure/
 * @package WooCommerce\Templates
 * @version 3.6.0
 */
use AudioteriaWP\Data\AbstractProducts;
if ( ! defined( 'ABSPATH' ) ) {
	exit; // Exit if accessed directly.
}

global $product;

$products_data = AbstractProducts::get_instance()->product_returned_schema($product, AbstractProducts::get_instance()->taxonomy, AbstractProducts::get_instance()->genre, []);
if ( ! wc_review_ratings_enabled() ) {
	return;
}

$rating_count = $product->get_rating_count();
$review_count = $product->get_review_count();
$average      = (int) $product->get_average_rating();

?>
<div>
<?php if (!empty($products_data['main_trailer'])) { ?>
  <button id="play-trailer">
    <span><?= __('Play Trailer', 'audioteria-wp') ?></span>
    <?= file_get_contents(AUDIOTERIA_ASSETS_ICONS_DIR. '/play-icon.svg') ?>
  </button>
<?php  }
  if ($average > 0) { ?>
    <div>
        <svg width="20" height="19" viewBox="0 0 20 19" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
                d="M17.5683 6.55172L12.8573 5.86705L10.7514 1.59761C10.6938 1.48072 10.5992 1.38609 10.4823 1.32857C10.1891 1.18384 9.8329 1.30445 9.68632 1.59761L7.58036 5.86705L2.86933 6.55172C2.73944 6.57027 2.62069 6.6315 2.52978 6.72428C2.41986 6.83725 2.35929 6.98924 2.36138 7.14684C2.36347 7.30445 2.42804 7.45478 2.54091 7.5648L5.9494 10.8879L5.14413 15.5804C5.12525 15.6896 5.13733 15.8019 5.179 15.9045C5.22067 16.0071 5.29027 16.096 5.3799 16.1611C5.46953 16.2262 5.57561 16.2649 5.68611 16.2728C5.79661 16.2807 5.90711 16.2574 6.00507 16.2057L10.2188 13.9903L14.4326 16.2057C14.5476 16.267 14.6812 16.2874 14.8093 16.2651C15.1321 16.2094 15.3492 15.9033 15.2935 15.5804L14.4883 10.8879L17.8968 7.5648C17.9895 7.47389 18.0508 7.35513 18.0693 7.22525C18.1194 6.90054 17.8931 6.59996 17.5683 6.55172Z"
                <?= $average >= 1 ? 'fill="#CB5715"': 'stroke="#CB5715" fill="#ffffff"' ?> />
        </svg>
        <svg width="20" height="19" viewBox="0 0 20 19" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
                d="M17.5683 6.55172L12.8573 5.86705L10.7514 1.59761C10.6938 1.48072 10.5992 1.38609 10.4823 1.32857C10.1891 1.18384 9.8329 1.30445 9.68632 1.59761L7.58036 5.86705L2.86933 6.55172C2.73944 6.57027 2.62069 6.6315 2.52978 6.72428C2.41986 6.83725 2.35929 6.98924 2.36138 7.14684C2.36347 7.30445 2.42804 7.45478 2.54091 7.5648L5.9494 10.8879L5.14413 15.5804C5.12525 15.6896 5.13733 15.8019 5.179 15.9045C5.22067 16.0071 5.29027 16.096 5.3799 16.1611C5.46953 16.2262 5.57561 16.2649 5.68611 16.2728C5.79661 16.2807 5.90711 16.2574 6.00507 16.2057L10.2188 13.9903L14.4326 16.2057C14.5476 16.267 14.6812 16.2874 14.8093 16.2651C15.1321 16.2094 15.3492 15.9033 15.2935 15.5804L14.4883 10.8879L17.8968 7.5648C17.9895 7.47389 18.0508 7.35513 18.0693 7.22525C18.1194 6.90054 17.8931 6.59996 17.5683 6.55172Z"
                <?= $average >= 2 ? 'fill="#CB5715"': 'stroke="#CB5715" fill="#ffffff"' ?> />
        </svg>
        <svg width="20" height="19" viewBox="0 0 20 19" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
                d="M17.5683 6.55172L12.8573 5.86705L10.7514 1.59761C10.6938 1.48072 10.5992 1.38609 10.4823 1.32857C10.1891 1.18384 9.8329 1.30445 9.68632 1.59761L7.58036 5.86705L2.86933 6.55172C2.73944 6.57027 2.62069 6.6315 2.52978 6.72428C2.41986 6.83725 2.35929 6.98924 2.36138 7.14684C2.36347 7.30445 2.42804 7.45478 2.54091 7.5648L5.9494 10.8879L5.14413 15.5804C5.12525 15.6896 5.13733 15.8019 5.179 15.9045C5.22067 16.0071 5.29027 16.096 5.3799 16.1611C5.46953 16.2262 5.57561 16.2649 5.68611 16.2728C5.79661 16.2807 5.90711 16.2574 6.00507 16.2057L10.2188 13.9903L14.4326 16.2057C14.5476 16.267 14.6812 16.2874 14.8093 16.2651C15.1321 16.2094 15.3492 15.9033 15.2935 15.5804L14.4883 10.8879L17.8968 7.5648C17.9895 7.47389 18.0508 7.35513 18.0693 7.22525C18.1194 6.90054 17.8931 6.59996 17.5683 6.55172Z"
                <?= $average >= 3 ? 'fill="#CB5715"': 'stroke="#CB5715" fill="#ffffff"' ?> />
        </svg>
        <svg width="20" height="19" viewBox="0 0 20 19" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
                d="M17.5683 6.55172L12.8573 5.86705L10.7514 1.59761C10.6938 1.48072 10.5992 1.38609 10.4823 1.32857C10.1891 1.18384 9.8329 1.30445 9.68632 1.59761L7.58036 5.86705L2.86933 6.55172C2.73944 6.57027 2.62069 6.6315 2.52978 6.72428C2.41986 6.83725 2.35929 6.98924 2.36138 7.14684C2.36347 7.30445 2.42804 7.45478 2.54091 7.5648L5.9494 10.8879L5.14413 15.5804C5.12525 15.6896 5.13733 15.8019 5.179 15.9045C5.22067 16.0071 5.29027 16.096 5.3799 16.1611C5.46953 16.2262 5.57561 16.2649 5.68611 16.2728C5.79661 16.2807 5.90711 16.2574 6.00507 16.2057L10.2188 13.9903L14.4326 16.2057C14.5476 16.267 14.6812 16.2874 14.8093 16.2651C15.1321 16.2094 15.3492 15.9033 15.2935 15.5804L14.4883 10.8879L17.8968 7.5648C17.9895 7.47389 18.0508 7.35513 18.0693 7.22525C18.1194 6.90054 17.8931 6.59996 17.5683 6.55172Z"
                <?= $average >= 4 ? 'fill="#CB5715"': 'stroke="#CB5715" fill="#ffffff"' ?> />
        </svg>
        <svg width="20" height="19" viewBox="0 0 20 19" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
                d="M17.5683 6.55172L12.8573 5.86705L10.7514 1.59761C10.6938 1.48072 10.5992 1.38609 10.4823 1.32857C10.1891 1.18384 9.8329 1.30445 9.68632 1.59761L7.58036 5.86705L2.86933 6.55172C2.73944 6.57027 2.62069 6.6315 2.52978 6.72428C2.41986 6.83725 2.35929 6.98924 2.36138 7.14684C2.36347 7.30445 2.42804 7.45478 2.54091 7.5648L5.9494 10.8879L5.14413 15.5804C5.12525 15.6896 5.13733 15.8019 5.179 15.9045C5.22067 16.0071 5.29027 16.096 5.3799 16.1611C5.46953 16.2262 5.57561 16.2649 5.68611 16.2728C5.79661 16.2807 5.90711 16.2574 6.00507 16.2057L10.2188 13.9903L14.4326 16.2057C14.5476 16.267 14.6812 16.2874 14.8093 16.2651C15.1321 16.2094 15.3492 15.9033 15.2935 15.5804L14.4883 10.8879L17.8968 7.5648C17.9895 7.47389 18.0508 7.35513 18.0693 7.22525C18.1194 6.90054 17.8931 6.59996 17.5683 6.55172Z"
                <?= $average >= 5 ? 'fill="#CB5715"': 'stroke="#CB5715" fill="#ffffff"' ?> />
        </svg>
    </div>
  <?php } elseif (AbstractProducts::get_instance()->has_bought_product( [$product->get_id()] ) && ! AbstractProducts::get_instance()->audioteria_wp_user_has_rated_product( $product->get_id() ) ) {

  } ?>
</div>
